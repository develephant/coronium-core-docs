



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://develephant.github.io/coronium-core-docs/client/modules/mysql/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../imgs/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.6.0">
    
    
      
        <title>MySQL - Coronium Core</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.aa3de92b.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.792431c1.css">
      
    
    
      <script src="../../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
      <link href="https://use.fontawesome.com/releases/v5.0.6/css/all.css" rel="stylesheet" >
    
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#select" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://develephant.github.io/coronium-core-docs" title="Coronium Core" class="md-header-nav__button md-logo">
          
            <img src="../../../imgs/rnd-dev.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Coronium Core
              </span>
              <span class="md-header-nav__topic">
                MySQL
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../../imgs/rnd-dev.png" width="24" height="24">
      
    </span>
    Coronium Core
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Core Server
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Core Server
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1">
    
    <label class="md-nav__link" for="nav-2-1">
      Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-1">
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/installation/digitalocean/" title="DigitalOcean" class="md-nav__link">
      DigitalOcean
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/installation/amazon/" title="Amazon EC2" class="md-nav__link">
      Amazon EC2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/installation/postinstall/" title="Post Install" class="md-nav__link">
      Post Install
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      Webmin
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        Webmin
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/webmin/setup/" title="Browser Access" class="md-nav__link">
      Browser Access
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/webmin/scope/" title="Application Scope" class="md-nav__link">
      Application Scope
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/webmin/mailgun/" title="Mailgun Config" class="md-nav__link">
      Mailgun Config
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/webmin/password/" title="Password" class="md-nav__link">
      Password
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">
    
    <label class="md-nav__link" for="nav-2-3">
      Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/guide/login/" title="Logging In" class="md-nav__link">
      Logging In
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/guide/key/" title="Server Key" class="md-nav__link">
      Server Key
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/guide/usage/" title="General Usage" class="md-nav__link">
      General Usage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/guide/ssl/" title="HTTPS/SSL" class="md-nav__link">
      HTTPS/SSL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/guide/lifecycle/" title="Lifecycle/Context" class="md-nav__link">
      Lifecycle/Context
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/guide/mongo/" title="Disabling MongoDB" class="md-nav__link">
      Disabling MongoDB
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4">
    
    <label class="md-nav__link" for="nav-2-4">
      Modules
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-4">
        Modules
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/modules/api/" title="API" class="md-nav__link">
      API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/modules/data/" title="Data" class="md-nav__link">
      Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/modules/email/" title="Email" class="md-nav__link">
      Email
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/modules/files/" title="Files" class="md-nav__link">
      Files
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4-5" type="checkbox" id="nav-2-4-5">
    
    <label class="md-nav__link" for="nav-2-4-5">
      Jobs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-4-5">
        Jobs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/modules/jobs/api/" title="Jobs API" class="md-nav__link">
      Jobs API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/modules/jobs/guide/" title="Jobs Guide" class="md-nav__link">
      Jobs Guide
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/modules/mongo/" title="Mongo" class="md-nav__link">
      Mongo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/modules/mysql/" title="MySQL" class="md-nav__link">
      MySQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/modules/network/" title="Network" class="md-nav__link">
      Network
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4-9" type="checkbox" id="nav-2-4-9">
    
    <label class="md-nav__link" for="nav-2-4-9">
      Pages
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-4-9">
        Pages
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/modules/pages/api/" title="Pages API" class="md-nav__link">
      Pages API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/modules/pages/usage/" title="Usage" class="md-nav__link">
      Usage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/modules/pages/templates/" title="Templates" class="md-nav__link">
      Templates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/modules/pages/ajax/" title="Using AJAX" class="md-nav__link">
      Using AJAX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/modules/pages/html5/" title="HTML5 Builds" class="md-nav__link">
      HTML5 Builds
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/modules/pages/errors/" title="Error Pages" class="md-nav__link">
      Error Pages
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/modules/template/" title="Template" class="md-nav__link">
      Template
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/modules/timer/" title="Timer" class="md-nav__link">
      Timer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4-12" type="checkbox" id="nav-2-4-12">
    
    <label class="md-nav__link" for="nav-2-4-12">
      Users
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-4-12">
        Users
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/modules/users/api/" title="Users API" class="md-nav__link">
      Users API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/modules/users/oauth/" title="OAuth API" class="md-nav__link">
      OAuth API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/modules/users/oauthusers/" title="OAuth Users" class="md-nav__link">
      OAuth Users
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/modules/users/confirmations/" title="Confirmations" class="md-nav__link">
      Confirmations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/modules/users/passwordreset/" title="Password Reset" class="md-nav__link">
      Password Reset
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/modules/utils/" title="Utils" class="md-nav__link">
      Utils
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/updates/" title="Updates" class="md-nav__link">
      Updates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../server/addons/" title="Add-ons" class="md-nav__link">
      Add-ons
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Core Client
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Core Client
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/" title="Usage" class="md-nav__link">
      Usage
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2" checked>
    
    <label class="md-nav__link" for="nav-3-2">
      Modules
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Modules
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../analytics/" title="Analytics" class="md-nav__link">
      Analytics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/" title="API" class="md-nav__link">
      API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../core/" title="Core" class="md-nav__link">
      Core
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data/" title="Data" class="md-nav__link">
      Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../email/" title="Email" class="md-nav__link">
      Email
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../files/" title="Files" class="md-nav__link">
      Files
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        MySQL
      </label>
    
    <a href="./" title="MySQL" class="md-nav__link md-nav__link--active">
      MySQL
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#select" title="select" class="md-nav__link">
    select
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#selectone" title="selectOne" class="md-nav__link">
    selectOne
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#selectbatch" title="selectBatch" class="md-nav__link">
    selectBatch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#selectmerge" title="selectMerge" class="md-nav__link">
    selectMerge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#selectcount" title="selectCount" class="md-nav__link">
    selectCount
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#insert" title="insert" class="md-nav__link">
    insert
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#insertmany" title="insertMany" class="md-nav__link">
    insertMany
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#insertbatch" title="insertBatch" class="md-nav__link">
    insertBatch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update" title="update" class="md-nav__link">
    update
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updatemany" title="updateMany" class="md-nav__link">
    updateMany
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updatebatch" title="updateBatch" class="md-nav__link">
    updateBatch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#delete" title="delete" class="md-nav__link">
    delete
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deletemany" title="deleteMany" class="md-nav__link">
    deleteMany
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deletebatch" title="deleteBatch" class="md-nav__link">
    deleteBatch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-where-key" title="The WHERE Key" class="md-nav__link">
    The WHERE Key
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#string-based" title="String Based" class="md-nav__link">
    String Based
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#table-based" title="Table Based" class="md-nav__link">
    Table Based
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optimized-methods" title="Optimized Methods" class="md-nav__link">
    Optimized Methods
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network-timeout" title="Network Timeout" class="md-nav__link">
    Network Timeout
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example" title="Example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2-8" type="checkbox" id="nav-3-2-8">
    
    <label class="md-nav__link" for="nav-3-2-8">
      Users
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-2-8">
        Users
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../users/api/" title="Users API" class="md-nav__link">
      Users API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../users/oauth/" title="OAuth API" class="md-nav__link">
      OAuth API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../users/creating/" title="Creating" class="md-nav__link">
      Creating
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../users/updating/" title="Updating" class="md-nav__link">
      Updating
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../users/login/" title="Logging In" class="md-nav__link">
      Logging In
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../users/confirmation/" title="Confirmation" class="md-nav__link">
      Confirmation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../codes/" title="Status Codes" class="md-nav__link">
      Status Codes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../demo/" title="Demo Project" class="md-nav__link">
      Demo Project
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../screencasts/" title="Screencasts" class="md-nav__link">
      Screencasts
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../about/" title="About" class="md-nav__link">
      About
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#select" title="select" class="md-nav__link">
    select
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#selectone" title="selectOne" class="md-nav__link">
    selectOne
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#selectbatch" title="selectBatch" class="md-nav__link">
    selectBatch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#selectmerge" title="selectMerge" class="md-nav__link">
    selectMerge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#selectcount" title="selectCount" class="md-nav__link">
    selectCount
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#insert" title="insert" class="md-nav__link">
    insert
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#insertmany" title="insertMany" class="md-nav__link">
    insertMany
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#insertbatch" title="insertBatch" class="md-nav__link">
    insertBatch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update" title="update" class="md-nav__link">
    update
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updatemany" title="updateMany" class="md-nav__link">
    updateMany
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updatebatch" title="updateBatch" class="md-nav__link">
    updateBatch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#delete" title="delete" class="md-nav__link">
    delete
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deletemany" title="deleteMany" class="md-nav__link">
    deleteMany
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deletebatch" title="deleteBatch" class="md-nav__link">
    deleteBatch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-where-key" title="The WHERE Key" class="md-nav__link">
    The WHERE Key
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#string-based" title="String Based" class="md-nav__link">
    String Based
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#table-based" title="Table Based" class="md-nav__link">
    Table Based
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optimized-methods" title="Optimized Methods" class="md-nav__link">
    Optimized Methods
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network-timeout" title="Network Timeout" class="md-nav__link">
    Network Timeout
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example" title="Example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>MySQL</h1>
                
                <p>Provides a client-side api to the <a href="../../../server/modules/mysql/#ez-query-methods">EZ query methods</a> of the server-side MySQL module. For more complex data handling, you must provide an <strong><a href="../../../server/modules/api/">api</a></strong> on the server-side.</p>
<div class="admonition warning">
<p class="admonition-title">Database Required</p>
<p><strong>Before you can use the MySQL module, you will need to create a MySQL database. See the <a href="../../../server/modules/mysql/#administration">Administration</a> section for more information on connecting to your database.</strong></p>
</div>
<h3 id="select">select</h3>
<p>Select multiple records from a database table.</p>
<div class="codehilite"><pre><span></span><span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="nb">select</span><span class="p">(</span><span class="n">query_tbl</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>
</pre></div>


<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>query_tbl</td>
<td>The query parameters for the call.</td>
<td><em>Table</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>listener</td>
<td>The api listener callback function.</td>
<td><em>Function</em></td>
<td><strong>Y</strong></td>
</tr>
</tbody>
</table>
<p><strong>Query Table Keys</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>db</td>
<td>The database to run the query against.</td>
<td><em>String</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>tbl</td>
<td>Name of the table to operate on.</td>
<td><em>String</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>columns</td>
<td>Array of columns to select as strings.</td>
<td><em>Table</em></td>
<td><strong>N</strong></td>
</tr>
<tr>
<td>where</td>
<td>Any additional WHERE clause to apply.</td>
<td><em>String</em> or <em>Table</em></td>
<td><strong>N</strong></td>
</tr>
<tr>
<td>orderby</td>
<td>The sorting attributes. See <strong>Orderby</strong> below.</td>
<td><em>Table</em></td>
<td><strong>N</strong></td>
</tr>
<tr>
<td>limit</td>
<td>Limit the records returned. See <strong>Limit</strong> below.</td>
<td><em>Number</em> or <em>Table</em></td>
<td><strong>N</strong></td>
</tr>
<tr>
<td>distinct</td>
<td>Filter out duplicate column values. Default: false</td>
<td><em>Boolean</em></td>
<td><strong>N</strong></td>
</tr>
</tbody>
</table>
<p><strong>Orderby</strong></p>
<p>The <strong>orderby</strong> key should be a table filled with <strong>column = direction</strong> pairs. The direction can be either "ASC" for ascending order or "DESC" for descending order.</p>
<p><strong>Limit</strong></p>
<p>To limit the rows returned, supply a <strong>number</strong> value to the <strong>limit</strong> key. To <em>offset</em> the limit, supply a <strong>table</strong> array of <strong>number</strong> values. For example, to return rows 6-15: <strong>limit = {5, 10}</strong>.</p>
<p><strong>Event Response</strong></p>
<p>On success, the <strong>result</strong> will contain a <strong>table</strong> array of records.</p>
<p><strong>Example</strong></p>
<p><em>Using the "app" database, select all records from the "users" table.</em></p>
<div class="codehilite"><pre><span></span><span class="kd">local</span> <span class="kr">function</span> <span class="nf">apiListener</span><span class="p">(</span> <span class="n">evt</span> <span class="p">)</span>
  <span class="kr">if</span> <span class="n">evt</span><span class="p">.</span><span class="n">error</span> <span class="kr">then</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">evt</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>
  <span class="kr">else</span>
    <span class="kr">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">#</span><span class="n">evt</span><span class="p">.</span><span class="n">result</span> <span class="kr">do</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">evt</span><span class="p">.</span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">id</span><span class="p">)</span>
    <span class="kr">end</span>
  <span class="kr">end</span>
<span class="kr">end</span>

<span class="kd">local</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">db</span> <span class="o">=</span> <span class="s2">&quot;app&quot;</span><span class="p">,</span>
  <span class="n">tbl</span> <span class="o">=</span> <span class="s2">&quot;users&quot;</span>
<span class="p">}</span>

<span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="nb">select</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">apiListener</span><span class="p">)</span>
</pre></div>


<div class="admonition tldr">
<p class="admonition-title">More Examples</p>
<p>See the server-side <strong><a href="../../../server/modules/mysql/#select">core.mysql.select</a></strong> method for more examples.</p>
</div>
<h3 id="selectone">selectOne</h3>
<p>Select and return a single record from a database table.</p>
<div class="codehilite"><pre><span></span><span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">selectOne</span><span class="p">(</span><span class="n">query_tbl</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>
</pre></div>


<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>query_tbl</td>
<td>The query parameters for the call.</td>
<td><em>Table</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>listener</td>
<td>The api listener callback function.</td>
<td><em>Function</em></td>
<td><strong>Y</strong></td>
</tr>
</tbody>
</table>
<p><strong>Query Table Keys</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>db</td>
<td>The database to run the query against.</td>
<td><em>String</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>tbl</td>
<td>Name of the table to operate on.</td>
<td><em>String</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>where</td>
<td>The WHERE clause to apply.</td>
<td><em>String</em> or <em>Table</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>columns</td>
<td>Array of columns to select as strings.</td>
<td><em>Table</em></td>
<td><strong>N</strong></td>
</tr>
</tbody>
</table>
<p><strong>Event Response</strong></p>
<p>On success, the <strong>result</strong> will contain a <strong>table</strong>.</p>
<div class="admonition info">
<p class="admonition-title">Special Response</p>
<p>Unlike the <strong><a href="#select">select</a></strong> method, the result is returned as a single record as opposed to an array of records.</p>
</div>
<p><strong>Example</strong></p>
<div class="codehilite"><pre><span></span><span class="kd">local</span> <span class="kr">function</span> <span class="nf">apiListener</span><span class="p">(</span> <span class="n">evt</span> <span class="p">)</span>
  <span class="kr">if</span> <span class="n">evt</span><span class="p">.</span><span class="n">error</span> <span class="kr">then</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">evt</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>
  <span class="kr">else</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">evt</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">name</span><span class="p">)</span>
  <span class="kr">end</span>
<span class="kr">end</span>

<span class="kd">local</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">db</span> <span class="o">=</span> <span class="s2">&quot;app&quot;</span><span class="p">,</span>
  <span class="n">tbl</span> <span class="o">=</span> <span class="s2">&quot;users&quot;</span><span class="p">,</span>
  <span class="n">where</span> <span class="o">=</span> <span class="p">{</span> <span class="n">user_id</span> <span class="o">=</span> <span class="mi">20</span> <span class="p">},</span>
  <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;name&quot;</span> <span class="p">}</span>
<span class="p">}</span>

<span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">selectOne</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">apiListener</span><span class="p">)</span>
</pre></div>


<h3 id="selectbatch">selectBatch</h3>
<p>Query multiple tables of a database and return the individual results in a keyed response.</p>
<div class="codehilite"><pre><span></span><span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">selectBatch</span><span class="p">(</span><span class="n">batch_tbl</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>
</pre></div>


<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>batch_tbl</td>
<td>The batch parameters for the call (see below).</td>
<td><em>Table</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>listener</td>
<td>The api listener callback function.</td>
<td><em>Function</em></td>
<td><strong>Y</strong></td>
</tr>
</tbody>
</table>
<p><strong>Batch Table Keys</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>db</td>
<td>The database to run the query against.</td>
<td><em>String</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>batch</td>
<td>A table array of EZ Query select tables, <strong>excluding the db key</strong>. (see <a href="#select">select</a>). Each select table must also include a <strong>key</strong> property for the result response (see example below).</td>
<td><em>Table</em></td>
<td><strong>Y</strong></td>
</tr>
</tbody>
</table>
<p><strong>Event Response</strong></p>
<p>On success, the <strong>result</strong> will be a keyed <strong>table</strong> with the results of each select query as a table array of records. If <code>limit</code> in any of the query entries is set to 1, then a single table with the record data is returned (not an array).</p>
<p><strong>Example</strong></p>
<div class="codehilite"><pre><span></span><span class="kd">local</span> <span class="kr">function</span> <span class="nf">apiListener</span><span class="p">(</span> <span class="n">evt</span> <span class="p">)</span>
  <span class="kr">if</span> <span class="n">evt</span><span class="p">.</span><span class="n">error</span> <span class="kr">then</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">evt</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>
  <span class="kr">else</span>
    <span class="kd">local</span> <span class="n">bikes</span> <span class="o">=</span> <span class="n">evt</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">bikes</span> <span class="c1">--Array of &quot;Bike&quot; records</span>
    <span class="kd">local</span> <span class="n">shoes</span> <span class="o">=</span> <span class="n">evt</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">shoes</span> <span class="c1">--Array of &quot;Shoe&quot; records</span>
    <span class="kd">local</span> <span class="n">store</span> <span class="o">=</span> <span class="n">evt</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">store</span> <span class="c1">--Table &quot;Store&quot; record</span>
  <span class="kr">end</span>
<span class="kr">end</span>

<span class="kd">local</span> <span class="n">batch_select</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">{</span>
    <span class="n">tbl</span> <span class="o">=</span> <span class="s2">&quot;products&quot;</span><span class="p">,</span>
    <span class="n">where</span> <span class="o">=</span> <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;Bike&quot;</span> <span class="p">},</span>
    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;bikes&quot;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="n">tbl</span> <span class="o">=</span> <span class="s2">&quot;products&quot;</span><span class="p">,</span>
    <span class="n">where</span> <span class="o">=</span> <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;Shoes&quot;</span> <span class="p">},</span>
    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;shoes&quot;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="n">tbl</span> <span class="o">=</span> <span class="s2">&quot;locations&quot;</span><span class="p">,</span>
    <span class="n">where</span> <span class="o">=</span> <span class="p">{</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Happy Toys&quot;</span> <span class="p">},</span>
    <span class="n">limit</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="c1">--Return as non-array record</span>
    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;store&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">local</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">db</span> <span class="o">=</span> <span class="s2">&quot;store&quot;</span><span class="p">,</span>
  <span class="n">batch</span> <span class="o">=</span> <span class="n">batch_select</span>
<span class="p">}</span>

<span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">selectBatch</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">apiListener</span><span class="p">)</span>
</pre></div>


<p><strong>Query Errors</strong></p>
<p>If any of the queries in the batch result in an error, the results key for that particular query will contain an <strong>error</strong> key. Best practice is to check for this key before accessing the results.</p>
<div class="codehilite"><pre><span></span><span class="c1">-- Assuming batch call as shown in the example above</span>

<span class="kd">local</span> <span class="kr">function</span> <span class="nf">apiListener</span><span class="p">(</span> <span class="n">evt</span> <span class="p">)</span>
  <span class="kr">if</span> <span class="n">evt</span><span class="p">.</span><span class="n">error</span> <span class="kr">then</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">evt</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>
  <span class="kr">else</span>
    <span class="kr">if</span> <span class="n">evt</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">bikes</span><span class="p">.</span><span class="n">error</span> <span class="kr">then</span>
      <span class="c1">--an error occurred on this particular query</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">evt</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">bikes</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>
    <span class="kr">else</span>
      <span class="c1">--loop over the records</span>
      <span class="kr">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">#</span><span class="n">evt</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">bikes</span> <span class="kr">do</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">evt</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">bikes</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">name</span><span class="p">)</span>
      <span class="kr">end</span>
    <span class="kr">end</span>
  <span class="kr">end</span>
<span class="kr">end</span>
</pre></div>


<h3 id="selectmerge">selectMerge</h3>
<p>Select from multiple databases and tables and return the results in a keyed table.</p>
<div class="codehilite"><pre><span></span><span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">selectMerge</span><span class="p">(</span><span class="n">merge_tbl</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>
</pre></div>


<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>merge_tbl</td>
<td>The merge parameters for the call (see below).</td>
<td><em>Table</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>listener</td>
<td>The api listener callback function.</td>
<td><em>Function</em></td>
<td><strong>Y</strong></td>
</tr>
</tbody>
</table>
<p><strong>Merge Table Keys</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>merge</td>
<td>A table array of EZ Query select tables. (see <a href="#select">select</a>). Each select table should also include a <code>key</code> property for the result table (see example below).</td>
<td><em>Table</em></td>
<td><strong>Y</strong></td>
</tr>
</tbody>
</table>
<p><strong>Event Response</strong></p>
<p>On success, the <strong>result</strong> will be a keyed <strong>table</strong> with the results of each select query. If <code>limit</code> in any of the query entries is set to 1, then a single table with the record data is returned (not an array). See <strong>Errors</strong> below.</p>
<p><strong>Example</strong></p>
<div class="codehilite"><pre><span></span><span class="kd">local</span> <span class="kr">function</span> <span class="nf">apiListener</span><span class="p">(</span> <span class="n">evt</span> <span class="p">)</span>
  <span class="kr">if</span> <span class="n">evt</span><span class="p">.</span><span class="n">error</span> <span class="kr">then</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">evt</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>
  <span class="kr">else</span>
    <span class="kd">local</span> <span class="n">locs</span> <span class="o">=</span> <span class="n">evt</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">locs</span>

    <span class="c1">--check for errors</span>
    <span class="kr">if</span> <span class="n">evt</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">errors</span> <span class="kr">then</span>
      <span class="kr">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">#</span><span class="n">evt</span><span class="p">.</span><span class="n">results</span><span class="p">.</span><span class="n">errors</span> <span class="kr">do</span>
        <span class="kd">local</span> <span class="n">err_tbl</span> <span class="o">=</span> <span class="n">evt</span><span class="p">.</span><span class="n">results</span><span class="p">.</span><span class="nb">error</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">err_tbl</span><span class="p">.</span><span class="n">db</span><span class="p">,</span> <span class="n">err_tbl</span><span class="p">.</span><span class="n">error</span><span class="p">,</span> <span class="n">err_tbl</span><span class="p">.</span><span class="n">index</span><span class="p">)</span>
      <span class="kr">end</span>
    <span class="kr">end</span>
  <span class="kr">end</span>
<span class="kr">end</span>

<span class="kd">local</span> <span class="n">merge_dbs</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">{</span>
    <span class="n">db</span> <span class="o">=</span> <span class="s2">&quot;locations&quot;</span><span class="p">,</span>
    <span class="n">tbl</span> <span class="o">=</span> <span class="s2">&quot;spots&quot;</span><span class="p">,</span>
    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;locs&quot;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="n">db</span> <span class="o">=</span> <span class="s2">&quot;products&quot;</span><span class="p">,</span>
    <span class="n">tbl</span> <span class="o">=</span> <span class="s2">&quot;parts&quot;</span><span class="p">,</span>
    <span class="n">where</span> <span class="o">=</span> <span class="p">{</span> <span class="n">part_id</span> <span class="o">=</span> <span class="mi">20</span> <span class="p">},</span>
    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;part&quot;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="n">db</span> <span class="o">=</span> <span class="s2">&quot;stores&quot;</span><span class="p">,</span>
    <span class="n">tbl</span> <span class="o">=</span> <span class="s2">&quot;toy&quot;</span><span class="p">,</span>
    <span class="n">limit</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="c1">--Return as non-array record</span>
    <span class="n">where</span> <span class="o">=</span> <span class="p">{</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Happy Toys&quot;</span> <span class="p">},</span>
    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;store&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">selectMerge</span><span class="p">({</span> <span class="n">merge</span> <span class="o">=</span> <span class="n">merge_dbs</span> <span class="p">},</span> <span class="n">apiListener</span><span class="p">)</span>
</pre></div>


<p><strong>Errors</strong></p>
<p>If any of the database queries fail, the successful queries will still be returned in their respective key names. On failed queries, the result will also contain an <code>errors</code> key, containing a table array describing any errors.</p>
<p><strong>Example Debug Response</strong></p>
<div class="codehilite"><pre><span></span>result:
  errors:
  1:
    db: products
    error: Table &#39;products.parts&#39; doesn&#39;t exist
    index: 2
    status: 1146
  locs:
  1:
    id: 1
    latitude: 80
    longitude: 200
    user_id: d23b8738-4d28-41ed-a967-98e83e855a38
  2:
    id: 3
    latitude: -64
    longitude: 200
    user_id: d23b8738-4d28-41ed-a967-98e83e855a39
  store:
    name = Happy Toys
    city = San Diego
</pre></div>


<h3 id="selectcount">selectCount</h3>
<p>Get a record count based on passed in query.</p>
<div class="codehilite"><pre><span></span><span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">selectCount</span><span class="p">(</span><span class="n">count_tbl</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>
</pre></div>


<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>count_tbl</td>
<td>The count parameters for the call (see below).</td>
<td><em>Table</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>listener</td>
<td>The api listener callback function.</td>
<td><em>Function</em></td>
<td><strong>Y</strong></td>
</tr>
</tbody>
</table>
<p><strong>Count Table Keys</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>db</td>
<td>The database to run the count query against.</td>
<td><em>String</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>tbl</td>
<td>Name of the table to operate with.</td>
<td><em>String</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>where</td>
<td>The WHERE clause to apply.</td>
<td><em>String</em> or <em>Table</em></td>
<td><strong>N</strong></td>
</tr>
<tr>
<td>column</td>
<td>The column to use as the counting key. Defaults to "id".</td>
<td><em>String</em></td>
<td><strong>N</strong></td>
</tr>
</tbody>
</table>
<p>If the <code>where</code> key is not included, the result is the total records in the provided table.</p>
<p><strong>Example</strong></p>
<div class="codehilite"><pre><span></span><span class="kd">local</span> <span class="kr">function</span> <span class="nf">apiListener</span><span class="p">(</span> <span class="n">evt</span> <span class="p">)</span>
  <span class="kr">if</span> <span class="n">evt</span><span class="p">.</span><span class="n">error</span> <span class="kr">then</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">evt</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>
  <span class="kr">else</span>
    <span class="kd">local</span> <span class="n">count</span> <span class="o">=</span> <span class="n">evt</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">count</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total red toys:&quot;</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
<span class="kr">end</span>

<span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">selectCount</span><span class="p">({</span>
  <span class="n">db</span> <span class="o">=</span> <span class="s2">&quot;products&quot;</span><span class="p">,</span>
  <span class="n">tbl</span> <span class="o">=</span> <span class="s2">&quot;toys&quot;</span><span class="p">,</span>
  <span class="n">where</span> <span class="o">=</span> <span class="p">{</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;Red&quot;</span> <span class="p">}</span>
<span class="p">},</span> <span class="n">apiListener</span><span class="p">)</span>
</pre></div>


<h3 id="insert">insert</h3>
<p>Insert a single record into a database table.</p>
<div class="codehilite"><pre><span></span><span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">query_tbl</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>
</pre></div>


<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>query_tbl</td>
<td>The query parameters for the call.</td>
<td><em>Table</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>listener</td>
<td>The api listener callback function.</td>
<td><em>Function</em></td>
<td><strong>Y</strong></td>
</tr>
</tbody>
</table>
<p><strong>Query Table Keys</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>db</td>
<td>The database to run the query against.</td>
<td><em>String</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>tbl</td>
<td>Name of the table to operate on.</td>
<td><em>String</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>values</td>
<td>A table of <strong>column = value</strong> pairs.</td>
<td><em>Table</em></td>
<td><strong>Y</strong></td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Important</p>
<p><strong>Strings in the <code>values</code> tables are run through the <a href="../../../server/modules/mysql/#escape">mysql.escape</a> method. Do not double-escape values.</strong></p>
</div>
<p><strong>Event Response</strong></p>
<p>On success, the <strong>result</strong> will contain the inserted record id as a <strong>number</strong>.</p>
<p><strong>Example</strong></p>
<div class="codehilite"><pre><span></span><span class="kd">local</span> <span class="kr">function</span> <span class="nf">apiListener</span><span class="p">(</span> <span class="n">evt</span> <span class="p">)</span>
  <span class="kr">if</span> <span class="n">evt</span><span class="p">.</span><span class="n">error</span> <span class="kr">then</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">evt</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>
  <span class="kr">else</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;insert id:&quot;</span><span class="p">,</span> <span class="n">evt</span><span class="p">.</span><span class="n">result</span><span class="p">)</span>
  <span class="kr">end</span>
<span class="kr">end</span>

<span class="kd">local</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">db</span> <span class="o">=</span> <span class="s2">&quot;app&quot;</span><span class="p">,</span>
  <span class="n">tbl</span> <span class="o">=</span> <span class="s2">&quot;users&quot;</span><span class="p">,</span>
  <span class="n">values</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Bobby&quot;</span><span class="p">,</span>
    <span class="n">age</span> <span class="o">=</span> <span class="mi">34</span>
  <span class="p">},</span>
<span class="p">}</span>

<span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">apiListener</span><span class="p">)</span>
</pre></div>


<h3 id="insertmany">insertMany</h3>
<p>Insert records into a single table of a database in an optimized way.</p>
<div class="codehilite"><pre><span></span><span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">insertMany</span><span class="p">(</span><span class="n">insert_tbl</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>
</pre></div>


<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>insert_tbl</td>
<td>The insert parameters table for the call (see below).</td>
<td><em>Table</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>listener</td>
<td>The api listener callback function.</td>
<td><em>Function</em></td>
<td><strong>Y</strong></td>
</tr>
</tbody>
</table>
<p><strong>Insert Table Keys</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>db</td>
<td>The database to run the inserts against.</td>
<td><em>String</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>tbl</td>
<td>Name of the table to operate on.</td>
<td><em>String</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>records</td>
<td>A table array of <code>values</code> tables from the <a href="#insert">insert</a> method.</td>
<td><em>Table</em></td>
<td><strong>Y</strong></td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Important</p>
<p><strong>Strings in the <code>values</code> tables are run through the <a href="../../../server/modules/mysql/#escape">mysql.escape</a> method. Do not double-escape values.</strong></p>
</div>
<p><strong>Event Response</strong></p>
<p>On success, the <strong>result</strong> will hold an indexed table array of tables containing either an <strong>id</strong> key; with the id of the newly created record, or an <strong>error</strong> key; containing the error string.</p>
<p>The response table is indexed the same order as the records table that was sent to the server.</p>
<p><strong>Example</strong></p>
<div class="codehilite"><pre><span></span><span class="kd">local</span> <span class="kr">function</span> <span class="nf">apiListener</span><span class="p">(</span> <span class="n">evt</span> <span class="p">)</span>
  <span class="kr">if</span> <span class="n">evt</span><span class="p">.</span><span class="n">error</span> <span class="kr">then</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">evt</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>
  <span class="kr">else</span>
    <span class="kr">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">#</span><span class="n">evt</span><span class="p">.</span><span class="n">result</span> <span class="kr">do</span>
      <span class="kd">local</span> <span class="n">entry</span> <span class="o">=</span> <span class="n">evt</span><span class="p">.</span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

      <span class="kr">if</span> <span class="n">entry</span><span class="p">.</span><span class="n">error</span> <span class="kr">then</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error in insert entry #&quot;</span><span class="o">..</span><span class="n">i</span><span class="o">..</span><span class="s2">&quot;: &quot;</span><span class="o">..</span><span class="n">entry</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>
      <span class="kr">else</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;inserted record with id: &quot;</span><span class="o">..</span><span class="n">entry</span><span class="p">.</span><span class="n">id</span><span class="o">..</span><span class="s2">&quot; for entry #&quot;</span><span class="o">..</span><span class="n">i</span><span class="p">)</span>
      <span class="kr">end</span>
    <span class="kr">end</span>
  <span class="kr">end</span>
<span class="kr">end</span>

<span class="kd">local</span> <span class="n">toys</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">{</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Car&quot;</span><span class="p">,</span>
    <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Teddy Bear&quot;</span><span class="p">,</span>
    <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;brown&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">local</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">db</span> <span class="o">=</span> <span class="s2">&quot;products&quot;</span><span class="p">,</span>
  <span class="n">tbl</span> <span class="o">=</span> <span class="s2">&quot;toys&quot;</span><span class="p">,</span>
  <span class="n">records</span> <span class="o">=</span> <span class="n">toys</span>
<span class="p">}</span>

<span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">insertMany</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">apiListener</span><span class="p">)</span>
</pre></div>


<h3 id="insertbatch">insertBatch</h3>
<p>Insert records into multiple tables of a database in an optimized way.</p>
<div class="codehilite"><pre><span></span><span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">insertBatch</span><span class="p">(</span><span class="n">batch_tbl</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>
</pre></div>


<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>batch_tbl</td>
<td>The batch parameters table for the call (see below).</td>
<td><em>Table</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>listener</td>
<td>The api listener callback function.</td>
<td><em>Function</em></td>
<td><strong>Y</strong></td>
</tr>
</tbody>
</table>
<p><strong>Batch Table Keys</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>db</td>
<td>The database to run the batch against.</td>
<td><em>String</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>batch</td>
<td>A table array of tables with the <code>tbl</code> and <code>values</code> keys from the <a href="#insert">insert</a> method.</td>
<td><em>Table</em></td>
<td><strong>Y</strong></td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Important</p>
<p><strong>Strings in the <code>values</code> tables are run through the <a href="../../../server/modules/mysql/#escape">mysql.escape</a> method. Do not double-escape values.</strong></p>
</div>
<p><strong>Event Response</strong></p>
<p>On success, the <strong>result</strong> will hold an indexed table array of tables containing either an <strong>id</strong> key; with the id of the newly created record, or an <strong>error</strong> key; containing the error string.</p>
<p>The response table is indexed the same order as the batch table that was sent to the server.</p>
<p><strong>Example</strong></p>
<div class="codehilite"><pre><span></span><span class="kd">local</span> <span class="kr">function</span> <span class="nf">apiListener</span><span class="p">(</span> <span class="n">evt</span> <span class="p">)</span>
  <span class="kr">if</span> <span class="n">evt</span><span class="p">.</span><span class="n">error</span> <span class="kr">then</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">evt</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>
  <span class="kr">else</span>
    <span class="kr">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">#</span><span class="n">evt</span><span class="p">.</span><span class="n">result</span> <span class="kr">do</span>
      <span class="kd">local</span> <span class="n">entry</span> <span class="o">=</span> <span class="n">evt</span><span class="p">.</span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

      <span class="kr">if</span> <span class="n">entry</span><span class="p">.</span><span class="n">error</span> <span class="kr">then</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error in insert entry #&quot;</span><span class="o">..</span><span class="n">i</span><span class="o">..</span><span class="s2">&quot;: &quot;</span><span class="o">..</span><span class="n">entry</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>
      <span class="kr">else</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;inserted record with id: &quot;</span><span class="o">..</span><span class="n">entry</span><span class="p">.</span><span class="n">id</span><span class="o">..</span><span class="s2">&quot; for entry #&quot;</span><span class="o">..</span><span class="n">i</span><span class="p">)</span>
      <span class="kr">end</span>
    <span class="kr">end</span>
  <span class="kr">end</span>
<span class="kr">end</span>

<span class="kd">local</span> <span class="n">batch_insert</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">{</span>
    <span class="n">tbl</span> <span class="o">=</span> <span class="s2">&quot;shoes&quot;</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">{</span>
      <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Adidas&quot;</span><span class="p">,</span>
      <span class="n">size</span> <span class="o">=</span> <span class="mi">12</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="n">tbl</span> <span class="o">=</span> <span class="s2">&quot;toys&quot;</span><span class="p">,</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">{</span>
      <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Car&quot;</span><span class="p">,</span>
      <span class="n">age_group</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="n">tbl</span> <span class="o">=</span> <span class="s2">&quot;toys&quot;</span><span class="p">,</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">{</span>
      <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Bear&quot;</span><span class="p">,</span>
      <span class="n">age_group</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
      <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;Brown&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">local</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">db</span> <span class="o">=</span> <span class="s2">&quot;products&quot;</span><span class="p">,</span>
  <span class="n">batch</span> <span class="o">=</span> <span class="n">batch_insert</span>
<span class="p">}</span>

<span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">insertBatch</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">apiListener</span><span class="p">)</span>
</pre></div>


<h3 id="update">update</h3>
<p>Update record(s) in a database table.</p>
<div class="codehilite"><pre><span></span><span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">query_tbl</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>
</pre></div>


<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>query_tbl</td>
<td>The query parameters for the call.</td>
<td><em>Table</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>listener</td>
<td>The api listener callback function.</td>
<td><em>Function</em></td>
<td><strong>Y</strong></td>
</tr>
</tbody>
</table>
<p><strong>Query Table Keys</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>db</td>
<td>The database to run the query against.</td>
<td><em>String</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>tbl</td>
<td>The name of the table to operate on.</td>
<td><em>String</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>values</td>
<td>A table of <strong>column = value</strong> pairs.</td>
<td><em>Table</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>where</td>
<td>Where the columns should be updated.</td>
<td><em>String</em> or <em>Table</em></td>
<td><strong>N</strong></td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Important</p>
<p><strong>Strings in the <code>values</code> tables are run through the <a href="../../../server/modules/mysql/#escape">mysql.escape</a> method. Do not double-escape values.</strong></p>
</div>
<p><strong>Event Response</strong></p>
<p>On success, the <strong>result</strong> will contain the amount of records updated as a <strong>number</strong>.</p>
<p><strong>Example</strong></p>
<div class="codehilite"><pre><span></span><span class="kd">local</span> <span class="kr">function</span> <span class="nf">apiListener</span><span class="p">(</span> <span class="n">evt</span> <span class="p">)</span>
  <span class="kr">if</span> <span class="n">evt</span><span class="p">.</span><span class="n">error</span> <span class="kr">then</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">evt</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>
  <span class="kr">else</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;updated:&quot;</span><span class="p">,</span> <span class="n">evt</span><span class="p">.</span><span class="n">result</span><span class="p">)</span>
  <span class="kr">end</span>
<span class="kr">end</span>

<span class="kd">local</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">db</span> <span class="o">=</span> <span class="s2">&quot;app&quot;</span><span class="p">,</span>
  <span class="n">tbl</span> <span class="o">=</span> <span class="s2">&quot;users&quot;</span><span class="p">,</span>
  <span class="n">values</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Paco&quot;</span>
  <span class="p">},</span>
  <span class="n">where</span> <span class="o">=</span> <span class="p">{</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Bobby&quot;</span> <span class="p">}</span>
<span class="p">}</span>

<span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">apiListener</span><span class="p">)</span>
</pre></div>


<h3 id="updatemany">updateMany</h3>
<p>Update records in a single table of a database in an optimized way.</p>
<div class="codehilite"><pre><span></span><span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">updateMany</span><span class="p">(</span><span class="n">update_tbl</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>
</pre></div>


<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>update_tbl</td>
<td>The update parameters table for the call (see below).</td>
<td><em>Table</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>listener</td>
<td>The api listener callback function.</td>
<td><em>Function</em></td>
<td><strong>Y</strong></td>
</tr>
</tbody>
</table>
<p><strong>Update Table Keys</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>db</td>
<td>The database to run the updates against.</td>
<td><em>String</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>tbl</td>
<td>Name of the table to operate on.</td>
<td><em>String</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>update</td>
<td>A table array of tables with the <code>values</code> and <code>where</code> keys from the <a href="#update">update</a> method.</td>
<td><em>Table</em></td>
<td><strong>Y</strong></td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Important</p>
<p><strong>Strings in the <code>values</code> tables are run through the <a href="../../../server/modules/mysql/#escape">mysql.escape</a> method. Do not double-escape values.</strong></p>
</div>
<p><strong>Event Response</strong></p>
<p>On success, the <strong>result</strong> will hold an indexed table array of tables containing either an <strong>updated</strong> key; with the number of records updated, or an <strong>error</strong> key; containing the error string.</p>
<p>The response table is indexed the same order as the update table that was sent to the server.</p>
<p><strong>Example</strong></p>
<div class="codehilite"><pre><span></span><span class="kd">local</span> <span class="kr">function</span> <span class="nf">apiListener</span><span class="p">(</span> <span class="n">evt</span> <span class="p">)</span>
  <span class="kr">if</span> <span class="n">evt</span><span class="p">.</span><span class="n">error</span> <span class="kr">then</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">evt</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>
  <span class="kr">else</span>
    <span class="kr">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">#</span><span class="n">evt</span><span class="p">.</span><span class="n">result</span> <span class="kr">do</span>
      <span class="kd">local</span> <span class="n">entry</span> <span class="o">=</span> <span class="n">evt</span><span class="p">.</span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

      <span class="kr">if</span> <span class="n">entry</span><span class="p">.</span><span class="n">error</span> <span class="kr">then</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error in update entry #&quot;</span><span class="o">..</span><span class="n">i</span><span class="o">..</span><span class="s2">&quot;: &quot;</span><span class="o">..</span><span class="n">entry</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>
      <span class="kr">else</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;updated &quot;</span><span class="o">..</span><span class="n">entry</span><span class="p">.</span><span class="n">updated</span><span class="o">..</span><span class="s2">&quot; records for entry #&quot;</span><span class="o">..</span><span class="n">i</span><span class="p">)</span>
      <span class="kr">end</span>
    <span class="kr">end</span>
  <span class="kr">end</span>
<span class="kr">end</span>

<span class="kd">local</span> <span class="n">update_tbl</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">{</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">{</span>
      <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Nike&quot;</span>
    <span class="p">},</span>
    <span class="n">where</span> <span class="o">=</span> <span class="p">{</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Adidas&quot;</span> <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">{</span>
      <span class="n">cost</span> <span class="o">=</span> <span class="s2">&quot;1.99&quot;</span>
    <span class="p">},</span>
    <span class="n">where</span> <span class="o">=</span> <span class="p">{</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">3</span> <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">local</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">db</span> <span class="o">=</span> <span class="s2">&quot;products&quot;</span><span class="p">,</span>
  <span class="n">tbl</span> <span class="o">=</span> <span class="s2">&quot;shoes&quot;</span><span class="p">,</span>
  <span class="n">update</span> <span class="o">=</span> <span class="n">update_tbl</span>
<span class="p">}</span>

<span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">updateMany</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">apiListener</span><span class="p">)</span>
</pre></div>


<h3 id="updatebatch">updateBatch</h3>
<p>Update records in multiple tables of a database in an optimized way.</p>
<div class="codehilite"><pre><span></span><span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">updateBatch</span><span class="p">(</span><span class="n">batch_tbl</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>
</pre></div>


<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>batch_tbl</td>
<td>The batch parameters table for the call (see below).</td>
<td><em>Table</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>listener</td>
<td>The api listener callback function.</td>
<td><em>Function</em></td>
<td><strong>Y</strong></td>
</tr>
</tbody>
</table>
<p><strong>Batch Table Keys</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>db</td>
<td>The database to run the batch against.</td>
<td><em>String</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>batch</td>
<td>A table array of tables with the <code>tbl</code>, <code>values</code> and <code>where</code> keys from the <a href="#update">update</a> method.</td>
<td><em>Table</em></td>
<td><strong>Y</strong></td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Important</p>
<p><strong>Strings in the <code>values</code> tables are run through the <a href="../../../server/modules/mysql/#escape">mysql.escape</a> method. Do not double-escape values.</strong></p>
</div>
<p><strong>Event Response</strong></p>
<p>On success, the <strong>result</strong> will hold an indexed table array of tables containing either an <strong>updated</strong> key; with the number of records updated, or an <strong>error</strong> key; containing the error string.</p>
<p>The response table is indexed the same order as the batch table that was sent to the server.</p>
<p><strong>Example</strong></p>
<div class="codehilite"><pre><span></span><span class="kd">local</span> <span class="kr">function</span> <span class="nf">apiListener</span><span class="p">(</span> <span class="n">evt</span> <span class="p">)</span>
  <span class="kr">if</span> <span class="n">evt</span><span class="p">.</span><span class="n">error</span> <span class="kr">then</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">evt</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>
  <span class="kr">else</span>
    <span class="kr">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">#</span><span class="n">evt</span><span class="p">.</span><span class="n">result</span> <span class="kr">do</span>
      <span class="kd">local</span> <span class="n">entry</span> <span class="o">=</span> <span class="n">evt</span><span class="p">.</span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

      <span class="kr">if</span> <span class="n">entry</span><span class="p">.</span><span class="n">error</span> <span class="kr">then</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error in update entry #&quot;</span><span class="o">..</span><span class="n">i</span><span class="o">..</span><span class="s2">&quot;: &quot;</span><span class="o">..</span><span class="n">entry</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>
      <span class="kr">else</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;updated &quot;</span><span class="o">..</span><span class="n">entry</span><span class="p">.</span><span class="n">updated</span><span class="o">..</span><span class="s2">&quot; records for entry #&quot;</span><span class="o">..</span><span class="n">i</span><span class="p">)</span>
      <span class="kr">end</span>
    <span class="kr">end</span>
  <span class="kr">end</span>
<span class="kr">end</span>

<span class="kd">local</span> <span class="n">batch_update</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">{</span>
    <span class="n">tbl</span> <span class="o">=</span> <span class="s2">&quot;shoes&quot;</span><span class="p">,</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">{</span>
      <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Adidas&quot;</span>
    <span class="p">},</span>
    <span class="n">where</span> <span class="o">=</span> <span class="p">{</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">3</span> <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="n">tbl</span> <span class="o">=</span> <span class="s2">&quot;toys&quot;</span><span class="p">,</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">{</span>
      <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Raggedy Ann&quot;</span><span class="p">,</span>
      <span class="n">gender</span> <span class="o">=</span> <span class="s2">&quot;female&quot;</span>
    <span class="p">},</span>
    <span class="n">where</span> <span class="o">=</span> <span class="p">{</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Raggedy Andy&quot;</span> <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="n">tbl</span> <span class="o">=</span> <span class="s2">&quot;toys&quot;</span><span class="p">,</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">{</span>
      <span class="n">company</span> <span class="o">=</span> <span class="s2">&quot;Tonka&quot;</span>
    <span class="p">},</span>
    <span class="n">where</span> <span class="o">=</span> <span class="p">{</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">4</span> <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">local</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">db</span> <span class="o">=</span> <span class="s2">&quot;products&quot;</span><span class="p">,</span>
  <span class="n">batch</span> <span class="o">=</span> <span class="n">batch_update</span>
<span class="p">}</span>

<span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">updateBatch</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">apiListener</span><span class="p">)</span>
</pre></div>


<h3 id="delete">delete</h3>
<p>Delete record(s) from a database table.</p>
<div class="codehilite"><pre><span></span><span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span><span class="n">query_tbl</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>
</pre></div>


<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>query_tbl</td>
<td>The query parameters table for the call (see below).</td>
<td><em>Table</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>listener</td>
<td>The api listener callback function.</td>
<td><em>Function</em></td>
<td><strong>Y</strong></td>
</tr>
</tbody>
</table>
<p><strong>Query Table Keys</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>db</td>
<td>The database to run the query against.</td>
<td><em>String</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>tbl</td>
<td>The name of the table to operate on.</td>
<td><em>String</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>where</td>
<td>A WHERE clause to limit deletions to.</td>
<td><em>String</em> or <em>Table</em></td>
<td><strong>N</strong></td>
</tr>
<tr>
<td>force</td>
<td>Disables safety check for missing <strong>where</strong> key.</td>
<td><em>Boolean</em></td>
<td><strong>N</strong></td>
</tr>
</tbody>
</table>
<div class="admonition info">
<p class="admonition-title">Force Delete</p>
<p><strong>To run the delete command without a </strong>where<strong> clause, you must set </strong>force<strong> to true.</strong></p>
</div>
<p><strong>Event Response</strong></p>
<p>On success, the <strong>result</strong> will contain the amount of records deleted as a <strong>number</strong>.</p>
<p><strong>Example</strong></p>
<div class="codehilite"><pre><span></span><span class="kd">local</span> <span class="kr">function</span> <span class="nf">apiListener</span><span class="p">(</span> <span class="n">evt</span> <span class="p">)</span>
  <span class="kr">if</span> <span class="n">evt</span><span class="p">.</span><span class="n">error</span> <span class="kr">then</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">evt</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>
  <span class="kr">else</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;deleted:&quot;</span><span class="p">,</span> <span class="n">evt</span><span class="p">.</span><span class="n">result</span><span class="p">)</span>
  <span class="kr">end</span>
<span class="kr">end</span>

<span class="kd">local</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">db</span> <span class="o">=</span> <span class="s2">&quot;app&quot;</span><span class="p">,</span>
  <span class="n">tbl</span> <span class="o">=</span> <span class="s2">&quot;users&quot;</span><span class="p">,</span>
  <span class="n">where</span> <span class="o">=</span> <span class="p">{</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">10</span> <span class="p">}</span>
<span class="p">}</span>

<span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">apiListener</span><span class="p">)</span>
</pre></div>


<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>See the server-side <strong><a href="../../../server/modules/mysql/#delete">core.mysql.delete</a></strong> method for more examples.</p>
</div>
<h3 id="deletemany">deleteMany</h3>
<p>Delete records from a single table in a database in an optimized way.</p>
<div class="codehilite"><pre><span></span><span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">deleteMany</span><span class="p">(</span><span class="n">delete_tbl</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>
</pre></div>


<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>delete_tbl</td>
<td>The delete parameters table for the call (see below).</td>
<td><em>Table</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>listener</td>
<td>The api listener callback function.</td>
<td><em>Function</em></td>
<td><strong>Y</strong></td>
</tr>
</tbody>
</table>
<p><strong>Delete Table Keys</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>db</td>
<td>The database to run the deletes against.</td>
<td><em>String</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>tbl</td>
<td>Name of the table to operate on.</td>
<td><em>String</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>delete</td>
<td>A table array of tables with the <code>where</code> key from the <a href="#delete">delete</a> method.</td>
<td><em>Table</em></td>
<td><strong>Y</strong></td>
</tr>
</tbody>
</table>
<p><strong>Event Response</strong></p>
<p>On success, the <strong>result</strong> will hold an indexed table array of tables containing either a <strong>deleted</strong> key; with the number of records deleted, or an <strong>error</strong> key; containing the error string.</p>
<p>The response table is indexed the same order as the delete table that was sent to the server.</p>
<p><strong>Example</strong></p>
<div class="codehilite"><pre><span></span><span class="kd">local</span> <span class="kr">function</span> <span class="nf">apiListener</span><span class="p">(</span> <span class="n">evt</span> <span class="p">)</span>
  <span class="kr">if</span> <span class="n">evt</span><span class="p">.</span><span class="n">error</span> <span class="kr">then</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">evt</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>
  <span class="kr">else</span>
    <span class="kr">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">#</span><span class="n">evt</span><span class="p">.</span><span class="n">result</span> <span class="kr">do</span>
      <span class="kd">local</span> <span class="n">entry</span> <span class="o">=</span> <span class="n">evt</span><span class="p">.</span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

      <span class="kr">if</span> <span class="n">entry</span><span class="p">.</span><span class="n">error</span> <span class="kr">then</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error in delete entry #&quot;</span><span class="o">..</span><span class="n">i</span><span class="o">..</span><span class="s2">&quot;: &quot;</span><span class="o">..</span><span class="n">entry</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>
      <span class="kr">else</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;deleted &quot;</span><span class="o">..</span><span class="n">entry</span><span class="p">.</span><span class="n">deleted</span><span class="o">..</span><span class="s2">&quot; records for entry #&quot;</span><span class="o">..</span><span class="n">i</span><span class="p">)</span>
      <span class="kr">end</span>
    <span class="kr">end</span>
  <span class="kr">end</span>
<span class="kr">end</span>

<span class="kd">local</span> <span class="n">delete_tbl</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">{</span>
    <span class="n">where</span> <span class="o">=</span> <span class="p">{</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">34</span> <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="n">where</span> <span class="o">=</span> <span class="p">{</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;Red&quot;</span> <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">local</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">db</span> <span class="o">=</span> <span class="s2">&quot;products&quot;</span><span class="p">,</span>
  <span class="n">tbl</span> <span class="o">=</span> <span class="s2">&quot;shoes&quot;</span><span class="p">,</span>
  <span class="n">delete</span> <span class="o">=</span> <span class="n">delete_tbl</span>
<span class="p">}</span>

<span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">deleteMany</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">apiListener</span><span class="p">)</span>
</pre></div>


<h3 id="deletebatch">deleteBatch</h3>
<p>Delete records from multiple tables of a database in an optimized way.</p>
<div class="codehilite"><pre><span></span><span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">deleteBatch</span><span class="p">(</span><span class="n">batch_tbl</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>
</pre></div>


<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>batch_tbl</td>
<td>The batch parameters table for the call (see below).</td>
<td><em>Table</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>listener</td>
<td>The api listener callback function.</td>
<td><em>Function</em></td>
<td><strong>Y</strong></td>
</tr>
</tbody>
</table>
<p><strong>Batch Table Keys</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>db</td>
<td>The database to run the batch against.</td>
<td><em>String</em></td>
<td><strong>Y</strong></td>
</tr>
<tr>
<td>batch</td>
<td>A table array of tables with the <code>tbl</code> and <code>where</code> keys from the <a href="#delete">delete</a> method.</td>
<td><em>Table</em></td>
<td><strong>Y</strong></td>
</tr>
</tbody>
</table>
<p><strong>Event Response</strong></p>
<p>On success, the <strong>result</strong> will hold an indexed table array of tables containing either a <strong>deleted</strong> key; with the number of records deleted, or an <strong>error</strong> key; containing the error string.</p>
<p>The response table is indexed the same order as the batch table that was sent to the server.</p>
<p><strong>Example</strong></p>
<div class="codehilite"><pre><span></span><span class="kd">local</span> <span class="kr">function</span> <span class="nf">apiListener</span><span class="p">(</span> <span class="n">evt</span> <span class="p">)</span>
  <span class="kr">if</span> <span class="n">evt</span><span class="p">.</span><span class="n">error</span> <span class="kr">then</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">evt</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>
  <span class="kr">else</span>
    <span class="kr">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">#</span><span class="n">evt</span><span class="p">.</span><span class="n">result</span> <span class="kr">do</span>
      <span class="kd">local</span> <span class="n">entry</span> <span class="o">=</span> <span class="n">evt</span><span class="p">.</span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

      <span class="kr">if</span> <span class="n">entry</span><span class="p">.</span><span class="n">error</span> <span class="kr">then</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error in delete entry #&quot;</span><span class="o">..</span><span class="n">i</span><span class="o">..</span><span class="s2">&quot;: &quot;</span><span class="o">..</span><span class="n">entry</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>
      <span class="kr">else</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;deleted &quot;</span><span class="o">..</span><span class="n">entry</span><span class="p">.</span><span class="n">deleted</span><span class="o">..</span><span class="s2">&quot; records for entry #&quot;</span><span class="o">..</span><span class="n">i</span><span class="p">)</span>
      <span class="kr">end</span>
    <span class="kr">end</span>
  <span class="kr">end</span>
<span class="kr">end</span>


<span class="kd">local</span> <span class="n">batch_delete</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">{</span>
    <span class="n">tbl</span> <span class="o">=</span> <span class="s2">&quot;toys&quot;</span><span class="p">,</span>
    <span class="n">where</span> <span class="o">=</span> <span class="p">{</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">2</span> <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="n">tbl</span> <span class="o">=</span> <span class="s2">&quot;shoes&quot;</span><span class="p">,</span>
    <span class="n">where</span> <span class="o">=</span> <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;running&quot;</span> <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">local</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">db</span> <span class="o">=</span> <span class="s2">&quot;products&quot;</span><span class="p">,</span>
  <span class="n">batch</span> <span class="o">=</span> <span class="n">batch_delete</span>
<span class="p">}</span>

<span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">deleteBatch</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">apiListener</span><span class="p">)</span>
</pre></div>


<h2 id="the-where-key">The WHERE Key</h2>
<p>Many of the MySQL (and other) modules use a <code>where</code> key to specify the "WHERE" clause for a database query. Depending on what data type and structure you provide this key, a couple different things can happen automagically.</p>
<h3 id="string-based">String Based</h3>
<p>When passing a string to the <code>where</code> key, you are on your own to create a valid MySQL query string. The query string is interpreted as-is. </p>
<p>You never include the literal "WHERE" in the <code>where</code> key value.</p>
<p><strong>Examples</strong></p>
<div class="codehilite"><pre><span></span>where = &quot;`color`=&#39;Red&#39;&quot;
</pre></div>


<div class="codehilite"><pre><span></span>where = &quot;`kind`=&#39;Truck&#39; AND `color`=&#39;Red&#39;&quot;
</pre></div>


<div class="codehilite"><pre><span></span>where = &quot;`kind`=&#39;Truck&#39; OR `kind`=&#39;Car&#39;&quot;
</pre></div>


<h3 id="table-based">Table Based</h3>
<p>The advantage of using a table based <code>where</code> key is that all of the values are properly formatted to make a valid and type-safe MySQL query.</p>
<div class="admonition warning">
<p class="admonition-title">Important</p>
<p><strong>String values are automatically run through <code>mysql.escape</code>. Do not double-escape values.</strong></p>
</div>
<p>To reproduce the three string based examples above as table based:</p>
<div class="codehilite"><pre><span></span><span class="n">where</span> <span class="o">=</span> <span class="p">{</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;Red&quot;</span> <span class="p">}</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="n">where</span> <span class="o">=</span> <span class="p">{</span> <span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;Truck&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;Red&quot;</span> <span class="p">}</span> <span class="c1">--AND</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="n">where</span> <span class="o">=</span> <span class="p">{</span> <span class="n">kind</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;Truck&quot;</span><span class="p">,</span> <span class="s2">&quot;Car&quot;</span> <span class="p">}</span> <span class="p">}</span> <span class="c1">--OR</span>
</pre></div>


<p><strong>Ordered Table Queries</strong></p>
<p>With "ordered" query tables you can replicate some more complex queries:</p>
<div class="codehilite"><pre><span></span>where = &quot;`color=&#39;Red&#39; AND `model`=&#39;Ford&#39; AND kind=&#39;Truck&#39; OR kind=&#39;Car&#39;&quot;
</pre></div>


<p>To reproduce the query above, put the entries in a table array (order matters):</p>
<div class="codehilite"><pre><span></span><span class="n">where</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">{</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="n">model</span> <span class="o">=</span> <span class="s2">&quot;Ford&quot;</span> <span class="p">},</span>
  <span class="p">{</span> <span class="n">kind</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;Truck&quot;</span><span class="p">,</span> <span class="s2">&quot;Car&quot;</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>For an all OR query like:</p>
<div class="codehilite"><pre><span></span>where = &quot;`color=&#39;Red&#39; OR `model`=&#39;Ford&#39; OR kind=&#39;Truck&#39; OR kind=&#39;Car&#39;&quot;
</pre></div>


<p>You can use an ordered table with a single entry:</p>
<div class="codehilite"><pre><span></span><span class="n">where</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">{</span> <span class="n">color</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;Red&quot;</span> <span class="p">},</span> <span class="n">model</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;Ford&quot;</span> <span class="p">},</span> <span class="n">kind</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;Truck&quot;</span><span class="p">,</span> <span class="s2">&quot;Car&quot;</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>At this time multiple entries in an "ordered" <code>where</code> table are combined using 'AND', which may cause problems with more complicated queries, so you'll need to fall back to the string method.</p>
<p>Table type queries also do not support conditionals, so the following cannot be replicated with a table based query:</p>
<div class="codehilite"><pre><span></span>where = &quot;`score` &gt; 100&quot;
</pre></div>


<h2 id="optimized-methods">Optimized Methods</h2>
<p>When working with multiple entries per query, try to choose an optimized query method. The reason for this is due to the fact that each Coronium Client network request to the server requires opening a new database connection per call.</p>
<p>By using the optimized query methods, the Coronium Core server can take advantage of using cached database connections, providing lower overhead and better performance.</p>
<p>Most optimized query methods also make it easier to program your application logic, by grouping results and using less calls.</p>
<p>The following are optimized MySQL module methods:</p>
<ul>
<li><code>selectBatch</code></li>
<li><code>selectMerge</code></li>
<li><code>insertMany</code></li>
<li><code>insertBatch</code></li>
<li><code>updateMany</code></li>
<li><code>updateBatch</code></li>
<li><code>deleteMany</code></li>
<li><code>deleteBatch</code></li>
</ul>
<h2 id="network-timeout">Network Timeout</h2>
<p>Though rare, very large workloads may cause the Corona client to throw a network timeout error before you receive a reponse from the server. In these cases you can add a <code>timeout</code> parameter to the <strong>query_tbl</strong> table.</p>
<p>The Corona default network timeout is 30 seconds. <em>This is an optional parameter</em>.</p>
<h3 id="example">Example</h3>
<div class="codehilite"><pre><span></span><span class="kd">local</span> <span class="kr">function</span> <span class="nf">apiListener</span><span class="p">(</span> <span class="n">evt</span> <span class="p">)</span>
  <span class="p">...</span>
<span class="kr">end</span>

<span class="kd">local</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">db</span> <span class="o">=</span> <span class="s2">&quot;app&quot;</span><span class="p">,</span>
  <span class="n">tbl</span> <span class="o">=</span> <span class="s2">&quot;users&quot;</span><span class="p">,</span>
  <span class="n">timeout</span> <span class="o">=</span> <span class="mi">60</span>
<span class="p">}</span>

<span class="n">core</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="nb">select</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">apiListener</span><span class="p">)</span>
</pre></div>


<div class="admonition note">
<p class="admonition-title">Server-Side Timeout</p>
<p>To adjust the MySQL server timeout for large queries, see <strong><a href="../../../server/modules/mysql/#mysql-timeout">MySQL Timeout</a></strong>.</p>
</div>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../files/" title="Files" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Files
              </span>
            </div>
          </a>
        
        
          <a href="../users/api/" title="Users API" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Users API
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            &copy;2018 C. Byerley (develephant) | <i class="fas fa-flask fa-sm"></i> v2.6.3
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
      <a href="https://forums.coronalabs.com/forum/643-coronium/" class="md-footer-social__link"><i class="far fa-life-ring"></i></a>
    
      <a href="https://twitter.com/develephant" class="md-footer-social__link"><i class="fab fa-twitter"></i></a>
    
      <a href="http://develephant.com" class="md-footer-social__link"><i class="fas fa-globe"></i></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.62cfdabc.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:"../../.."}})</script>
      
    
    
      
    
  </body>
</html>